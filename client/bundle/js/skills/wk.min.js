game.skills.wk={stun:{cast:function(a,b,c){var d=b,e=a.data("stun duration"),f=a.data("dot duration");"turn"===game.status&&game.states.table.animateCast(a,c,game.states.table.playerCemitery),d.damage(a.data("damage"),c,a.data("damage type")),d.addStun(c,e),c.on("turnend.wk-stun",this.dot).data("wk-stun",{duration:e+f,source:b,skill:a})},dot:function(a,b){var c,d=b.target,e=d.data("wk-stun"),f=e.source,g=e.skill,h=g.data("dot duration"),i=e.duration;i>0?(i===h&&(f.addBuff(d,g.data("buff"),h),c=d.data("speed")-1,d.data("current speed",c)),h>=i&&f.damage(g.data("dot"),d,g.data("damage type")),e.duration-=1,d.data("wk-stun",e)):(c=d.data("speed")+1,d.data("current speed",c),d.removeBuff("wk-stun"),d.off("turnend.wk-stun"),d.data("wk-stun",null))}},lifesteal:{passive:function(a,b){var c=b.data("side"),d=$(".card.heroes."+c);d.on("attack.wk-lifesteal",this.attack),d.data("wk-lifesteal",a),b.addBuff(d,a.data("buff")),b.on("die.wk-lifesteal",this.die),b.on("reborn.wk-lifesteal",this.reborn)},attack:function(a,b){var c=b.source,d=(b.target,c.data("current damage")),e=c.data("wk-lifesteal"),f=e.data("percentage")/100;c.heal(d*f)},die:function(a,b){var c=b.target,d=c.data("side"),e=$(".card.heroes."+d);e.removeBuff("wk-lifesteal"),e.off("attack.wk-lifesteal"),e.data("wk-lifesteal",null)},reborn:function(a,b){var c=b.target,d=c.data("wk-lifesteal"),e=c.data("side"),f=$(".card.heroes."+e);c.addBuff(f,d.data("buff")),f.on("attack.wk-lifesteal",this.attack),f.data("wk-lifesteal",d)}},crit:{passive:function(a,b){b.addBuff(b,a.data("buff")),b.on({"attack.wk":this.attack,"afterattack.wk":this.afterattack}).data("wk-crit",a)},attack:function(a,b){var c=b.source,d=(b.target,c.data("wk-crit")),e=c.data("current damage"),f=d.data("chance")/100,g=d.data("percentage")/100;game.random()<f&&(game.audio.play("crit"),e*=g,c.data({crit:!0,currentdamage:e}))},afterattack:function(a,b){var c=b.source;c.data("current damage",c.data("damage"))}},ult:{passive:function(a,b){b.on("die.wk-ult",this.die),b.data("wk-ult-skill",a)},die:function(a,b){var c=b.target,d=b.spot,e=c.data("wk-ult-skill");$("#"+d).addClass("cript"),c.on("turnstart.wk-ult",game.skills.wk.ult.resurrect).data("wk-ult",{skill:e,spot:d,duration:e.data("delay")}),game.map.inRange(d,game.map.getRange(e.data("aoe range")),function(a){var b="enemy",d=c.data("side");"enemy"===d&&(b="player");var f=a.find(".card."+b);if(f.length){c.addBuff(f,e.data("buff"));var g=f.data("speed")-1;f.data("current speed",g),f.on("turnstart.wk-ult",game.skills.wk.ult.turnstart),f.data("wk-ult",e.data("duration"))}}),c.off("die.wk-ult")},resurrect:function(a,b){var c=b.target,d=c.data("wk-ult"),e=(d.skill,d.spot),f=d.duration;c.data("side");f>0?(d.duration-=1,c.data("wk-ult",d)):($("#"+e).removeClass("cript"),c.reborn(e).data("wk-ult",null),c.off("turnstart.wk-ult"))},turnstart:function(a,b){var c=b.target,d=c.data("wk-ult");if(d>0)d-=1,c.data("wk-ult",d);else{var e=c.data("current speed")+1;c.data("current speed",e),c.off("turnstart.wk-ult"),c.data("wk-ult",null),c.removeBuff("wk-ult")}}}};