game.skills.cm={slow:{cast:function(a,b,c){var d=game.map.getPosition(c);"turn"===game.status&&game.states.table.animateCast(a,d,game.states.table.playerCemitery);var e=b.data("side"),f="enemy"===e?"player":"enemy";game.map.inRange(d,game.map.getRange(a.data("aoe range")),function(c){var d=c.find(".card."+f);if(d.length)if(b.damage(a.data("damage"),d,a.data("damage type")),d.data("cm-slow"))d.data("cm-slow",a.data("duration"));else{d.data("cm-slow",a.data("duration")),b.addBuff(d,a.data("buff"));var e=d.data("speed")-1;d.data("current speed",e),d.on("turnstart.cm-slow",game.skills.cm.slow.turnstart)}})},turnstart:function(a,b){var c=b.target,d=c.data("cm-slow");if(d>0)d-=1,c.data("cm-slow",d);else{var e=c.data("current speed")+1;c.data("current speed",e),c.off("turnstart.cm-slow"),c.data("cm-slow",null),c.removeBuff("cm-slow")}}},aura:{passive:function(a,b){var c=b.data("side");game[c].cardsPerTurn+=1,b.on("die.cm-aura"),b.on("reborn.cm-aura"),b.addBuff(b,a.data("buff"))},die:function(a,b){var c=b.target,d=c.data("side");game[d].cardsPerTurn-=1},reborn:function(a,b){var c=b.target,d=c.data("side");game[d].cardsPerTurn+=1}},freeze:{cast:function(a,b,c){b.addBuff(c,a.data("buff")),c.addClass("frozen"),c.data("cm-freeze",{source:b,skill:a,duration:a.data("duration")}),c.on("turnend.cm-freeze",this.dot)},dot:function(a,b){var c=b.target,d=c.data("cm-freeze"),e=d.source,f=d.skill,g=d.duration;g>0?(e.damage(f.data("dot"),c,f.data("damage type")),g-=1,d.duration=g,c.data("cm-freeze",d)):(c.removeClass("frozen"),c.data("cm-freeze",null),c.off("turnend.cm-freeze"),c.removeBuff("cm-freeze"))}},ult:{cast:function(a,b){var c=game.map.getPosition(b);"turn"===game.status&&game.states.table.animateCast(a,c,game.states.table.playerCemitery),b.on("channel",game.skills.cm.ult.channel).data("cm-ult",a),b.trigger("channel",{target:b})},channel:function(a,b){var c=b.target,d=c.data("cm-ult"),e=game.map.getPosition(c),f=c.data("side"),g="enemy"===f?"player":"enemy";game.map.inRange(e,game.map.getRange(d.data("aoe range")),function(a){var b=a.find(".card."+g);if(b.length)if(c.damage(d.data("damage"),b,d.data("damage type")),b.data("cm-ult"))b.data("cm-ult",d.data("duration"));else{b.data("cm-ult",d.data("duration")),c.addBuff(b,d.data("buff"));var e=b.data("speed")-1;b.data("current speed",e),b.on("turnstart.cm-ult",game.skills.cm.ult.turnstart)}})},turnstart:function(a,b){var c=b.target,d=c.data("cm-ult");if(d>0)d-=1,c.data("cm-ult",d);else{var e=c.data("current speed")+1;c.data("current speed",e),c.off("turnstart.cm-ult"),c.data("cm-ult",null),c.removeBuff("cm-ult")}}}};