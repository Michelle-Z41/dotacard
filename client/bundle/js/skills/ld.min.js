game.skills.ld={summon:{cast:function(a,b,c){var d=b.data("side"),e=$("."+d+".unit.ld.spiritbear");e.hasClass("summoned")?e.addClass("summoned"):(b.data("bear",e),e.addBuff(e,game.data.buffs.ld.demolish),e.data("ld",b),e.data("ld-demolish",a.data("demolish percentage")),e.on("attack",this.demolish),e.addBuff(e,game.data.buffs.ld.entangle),e.on("attack",this.entangle),e.data("ld-entangle-skill",a),e.data("ld-return-cooldown",a.data("return cooldown")),e.on("damage",game.skills.ld.bearreturn.breakreturn),e.on("death",game.skills.ld.summon.death));var f=$("."+d+".skill.ld-return");f.appendTo(game.player.skills.temp),e.changehp(e.data("hp")),e.place(c),"player"===d&&e.select()},demolish:function(a,b){var c=b.source,d=b.target;if(d.hasClass("tower")){var e=c.data("current damage")*c.data("ld-demolish")/100;c.damage(e,d,"Physical")}},entangle:function(a,b){var c=b.source,d=b.target,e=c.data("ld-entangle-skill"),f=e.data("entangle chance")/100;game.random()<f&&!d.hasClass("entangled")&&(c.addBuff(d,game.data.buffs.ld.entangle),d.addClass("entangled"),d.data("ld-entangle",{duration:e.data("entangle duration"),source:c,skill:e}),d.on("turnend.ld-entangle",game.skills.ld.summon.entangling))},entangling:function(a,b){var c=b.target,d=c.data("ld-entangle"),e=d.skill,f=d.source;d.duration>0?(d.duration-=1,c.data("ld-entangle",d),f.damage(e.data("entangle damage"),c,"Physical")):(c.removeClass("entangled"),c.off("turnend.ld-entangle"),c.data("ld-entangle",null),c.removeBuff("ld-entangle"))},death:function(){}},bearreturn:{cast:function(a,b,c){var d=b.data("side"),e=$("."+d+".hero.ld"),f=e.data("bear");f.css({opacity:0}),"turn"===game.status&&a.css({opacity:0}),setTimeout(function(){this.bear.place(this.target).css({opacity:1}),this.ld.select()}.bind({ld:e,bear:f,target:c}),400)},breakreturn:function(a,b){var c=b.target,d=c.data("side"),e=$("."+d+".skill.ld-return");e.appendTo(game.states.table.playerTemp),c.data("current-return-cooldown",c.data("ld-return-cooldown")),c.on("turnstart.ld-return",game.skills.ld.bearreturn.turnstart)},turnstart:function(a,b){var c=b.target,d=(c.data("side"),c.data("current-return-cooldown"));d>0?d-=1:(c.data("current-return-cooldown",null),c.off("turnstart.ld-return"))}},rabid:{cast:function(a,b){var c=b.data("side"),d=$("."+c+".hero.ld");d.addBuff(d,a.data("buff"));var e=d.data("current damage");d.changedamage(e+a.data("damage bonus"));var f=d.data("current speed");d.data("current speed",f+1);var g=d.data("bear");if(g&&!g.hasClass("dead")){var h=g.data("current damage");g.changedamage(h+a.data("damage bonus"));var i=g.data("current speed");g.data("current speed",i+1),d.addBuff(g,a.data("buff"))}d.data("ld-rabid",a.data("duration")),d.data("ld-rabid-damage-bonus",a.data("damage bonus")),d.on("turnstart.ld-rabid",game.skills.ld.rabid.turnstart)},turnstart:function(a,b){var c=b.target,d=c.data("ld-rabid");if(d>0)d-=1,c.data("ld-rabid",d);else{var e=c.data("current damage");c.changedamage(e-c.data("ld-rabid-damage-bonus"));var f=c.data("current speed");c.data("current speed",f-1),c.off("turnstart.ld-rabid"),c.data("ld-rabid",null),c.removeBuff("ld-rabid");var g=c.data("bear");if(g&&g.hasBuff("ld-rabid")){var h=g.data("current damage");g.changedamage(h-c.data("ld-rabid-damage-bonus"));var i=g.data("current speed");g.data("current speed",i-1),g.removeBuff("ld-rabid")}}}},passive:{passive:function(a,b){var c=b.data("side"),d=$("."+c+".hero.ld");d.addBuff(d,a.data("buff"));var e=$("."+c+".skill.ld-rabid"),f=e.data("duration");e.data("duration",f+a.data("rabid bonus"));var g=$("."+c+".skill.ld-ult"),h=g.data("hp bonus");g.data("hp bonus",h+a.data("ult bonus"));var i=d.data("bear");if(i){d.addBuff(i,a.data("buff"));var j=i.data("current damage");i.changedamage(j+a.data("bear bonus"));var k=i.data("hp"),l=i.data("current hp"),m=l/k;i.data("hp",k+a.data("hp bonus")),i.data("current hp",i.data("hp")*m)}}},ult:{toggle:function(a,b){b.hasClass("transformed")?game.skills.ld.ult.cast(a,b):game.skills.ld.transform.cast(a,b)},cast:function(a,b){var c=b.data("side"),d=$("."+c+".skill.ld-transform");d.appendTo(game.player.skills.permanent);var e=$("."+c+".skill.ld-cry");e.appendTo(game.player.skills.permanent),a.appendTo(game.player.skills.temp);var f=b.data("hp"),g=b.data("current hp"),h=g/f;b.data("hp",f+a.data("hp bonus")),b.data("current hp",b.data("hp")*h);b.data("armor");b.data("armor",+a.data("armor bonus")),b.data("range",game.data.ui.melee),b.addClass("transformed")}},transform:{cast:function(a,b){var c=b.data("side"),d=$("."+c+".skill.ld-ult");d.appendTo(game.player.skills.permanent),a.appendTo(game.player.skills.temp);var e=$("."+c+".skill.ld-cry");e.appendTo(game.player.skills.temp);var f=b.data("hp"),g=b.data("current hp"),h=g/f;b.data("hp",f-a.data("hp bonus")),b.data("current hp",b.data("hp")*h);b.data("armor");b.data("armor",-a.data("armor bonus")),b.data("range",game.data.ui["short"]),b.removeClass("transformed")}},cry:{cast:function(a,b){b.addBuff(b,a.data("buff"));b.data("armor");b.data("armor",+a.data("armor bonus"));var c=b.data("current damage");b.changedamage(c+a.data("damage bonus"));var d=b.data("bear");if(d){b.addBuff(d,a.data("buff"));var e=d.data("armor");d.data("armor",e+a.data("armor bonus"));var f=d.data("current damage");d.changedamage(f+a.data("damage bonus"))}b.data("ld-cry",a.data("duration")),b.data("ld-cry-damage-bonus",a.data("damage bonus")),b.data("ld-cry-armor-bonus",a.data("armor bonus")),b.on("turnstart.ld-cry",game.skills.ld.cry.turnstart),a.appendTo(game.player.skills.temp)},turnstart:function(a,b){var c=b.target,d=c.data("ld-cry");if(d>0)d-=1,c.data("ld-cry",d);else{var e=c.data("current damage");c.changedamage(e-c.data("ld-cry-damage-bonus"));var f=c.data("armor");c.data("armor",f-c.data("ld-cry-armor-bonus")),c.off("turnstart.ld-cry"),c.data("ld-cry",null),c.removeBuff("ld-cry");var g=c.data("bear");if(g&&g.hasBuff("ld-cry")){var h=g.data("current damage");g.changedamage(h-c.data("ld-cry-damage-bonus"));var i=g.data("armor bonus");g.data("armor bonus",i-c.data("ld-cry-armor-bonus")),g.removeBuff("ld-rabid")}}}}};