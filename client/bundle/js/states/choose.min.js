game.states.choose={build:function(){this.pickbox=$("<div>").appendTo(this.el).addClass("pickbox").attr("title",game.data.ui.chooseheroes),this.pickedbox=$("<div>").appendTo(this.el).addClass("pickedbox").hide().onrightClick(game.events.cancel);var a;for(a=0;5>a;a+=1)$("<div>").appendTo(this.pickedbox).attr({title:game.data.ui.rightpick}).data("slot",a).addClass("slot available").onrightClick(game.states.choose.pick);this.prepickbox=$("<div>").appendTo(this.el).addClass("prepickbox").html(game.data.ui.customdecks).hide(),this.counter=$("<p>").appendTo(this.pickedbox).addClass("counter").hide(),this.pickDeck=game.deck.build({name:"heroes",cb:function(a){a.addClass("pickdeck").appendTo(game.states.choose.pickbox),game.states.choose.size=100,$.each(a.data("cards"),function(a,b){b.data("disable")&&b.addClass("dead"),b.on("mousedown.select",game.states.choose.select),$.each(game.data.skills[b.data("hero")],function(){this.display&&b.addBuff(b,this)})}),a.width(100+$(".card").width()*a.children().length)}})},start:function(){game.loader.addClass("loading"),game[game.mode].build(),game.chat.el.appendTo(this.el),game.states.choose.selectFirst()},select:function(){var a=$(this);$(".choose .card.selected").removeClass("selected"),a.addClass("selected"),a.attr("draggable","true"),game.states.choose.pickDeck.css("margin-left",a.index()*a.width()/2*-1)},enablePick:function(){game.states.choose.pickEnabled=!0,game.states.choose.pickedbox.show(),game.player.picks=[],"tutorial"!==game.mode&&game.states.choose.prepickbox.show()},disablePick:function(){game.states.choose.pickEnabled=!1},pick:function(){var a,b=$(this).closest(".slot"),c=$(".pickbox .card.selected");return!c.data("disable")&&game.states.choose.pickEnabled&&(game.audio.play("activate"),b.hasClass("available")?(b.removeClass("available"),a=c.prev().length?c.prev():c.next()):(a=b.children(".card"),a.on("mousedown.select",game.states.choose.select).insertBefore(c)),a.addClass("selected"),a.attr("draggable","true"),c.removeClass("selected").appendTo(b).off("mousedown.select").attr("draggable","false"),game.states.choose.pickDeck.css("margin-left",a.index()*a.width()/2*-1),game.player.picks[b.data("slot")]=c.data("hero"),c.trigger("pick"),game.player.manaBuild(),game[game.mode].pick()),!1},selectFirst:function(){game.states.choose.select.call(game.states.choose.pickDeck.children().first())},reset:function(){$(".pickedbox .card").prependTo(this.pickDeck).on("mousedown.select",game.states.choose.select),$(".slot").addClass("available"),game.states.choose.counter.hide()},end:function(){this.pickedbox.hide(),this.prepickbox.hide()}};